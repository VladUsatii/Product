{% extends "blog/base.html" %}
{% load app_filters %}
{% load static %} <!-- Don't know why this has to be loaded? -->
{% block content %}

<!-- Explore new groups area -->

<div class="right-side-bar">
    {% for ad in ads %}
    {% if ad.image %}
    {% if forloop.last %}
    <a href="{% url 'ad-detail' ad.id %}" target="_self" style="color: inherit;text-decoration:none;">
        <div class="covid-warning" style="background-color: transparent;border:none;color:inherit;max-height:200px;margin-bottom: -25px;">
        <div class="cutoff" style="position:relative;top:50px;height:150px;max-width: 150px;">    
            <img src="{{ ad.image.url }}" alt="{{ ad.name }} image" class="img-market">
        </div>
            <div class="contain-covid-warning">
        <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 14px;color:rgb(181, 181, 181);font-weight: 500;padding-left:20px;top:-50px;">Sponsored <i class="fas fa-external-link-alt"></i></p>
                <h2 style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 18px;color:rgb(227, 227, 227);font-weight: 300;top: -100px;padding-left:20px;">{{ ad.title }}</h2>
                <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 13px;color:rgb(255, 255, 255);font-weight: 300;top: -150px;padding-left:20px;line-height: 18px;">{{ ad.content }}</p>
            </div>
        </div>
    </a>
    {% endif %}
    {% endif %}
    {% endfor %}
    <div class="right-side-blog-view">
        <h1 class="author-date-detail" style="text-align:left;font-weight:800;color:white;font-size:26px;font-family:'Kievit Serif', sans-serif;white-space: pre-wrap;word-wrap: break-all;padding-bottom: 0px;">Trending Posts&nbsp;&nbsp;<i class="fas fa-poll"></i></h1>
        <hr style="border: solid 1px rgb(167, 167, 167);" />
            {% for post in trending %}
            <a href="{% url 'post-detail' post.id %}" style="text-decoration:none;color:inherit;">
                <button class="trending-box" style="text-align: left;left:0;">
                    <img src="{{ post.author.profile.image.url }}" class="trending-box-author">
                    <h1 class="trending-box-title" style="font-weight: 900;color:rgb(181, 181, 181);">{{ post.author|truncatechars:32 }}&nbsp;&nbsp;&nbsp;</h1>
                    <h1 class="trending-box-title">{% if post.title %}{{ post.title|truncatechars:32 }}{% else %}{{ post.content|truncatechars:32 }}{% endif %}</h1>
                    <p class="trending-box-views">{{ post.blog_views|cool_num }} <i class="far fa-eye"></i></p>
                </button>
            </a>
            {% endfor %}
    </div>
    <div class="right-side-blog-view" style="background-color:transparent;border:none;">
        <a href="{% url 'product-updates' %}" style="color:inherit;text-decoration:none;"><button style="border:none;background-color:transparent;width:100%;" tooltip="Read launch notes" flow="down2"><img src="../media/productAlpha.png" style="max-width: 100%;border-radius: 5px;"></button></a>
    </div>
</div>
    <div class="appearonmobile2"><a href="{% url 'product-updates' %}" style="color:inherit;text-decoration:none;"><button style="border:solid 2px rgb(164, 164, 164);border-radius:10px;padding: 10px;background-color:transparent;width:100%;color:white;font-family: 'Philosopher', sans-serif;font-size:18px;padding-left:25px;padding-right:25px;">Product just launched. Read about the alpha here.</button></a></div>
    <div class="covid-warning" style="border-radius: 5px;">
        <img class="img-covid-warning" style="position: relative;height: 75px;margin: 20px;" src="{% static 'blog/covid.png' %}">
        <div class="contain-covid-warning">
            <h1 class="h1-covid-warning">Covid-19 is a scary outbreak.</h1>
            <h3 class="h3-covid-warning">Follow all safety regulations and get real coverage <a href="{% url 'blog-news' %}" class="a">here.</a></h3>
        </div>  
    </div>
    <div class="container-header">
        <h1 style="font-family: 'Kievit Serif Bold',sans-serif;color: white;padding-right: 25px;display: inline-block;">Latest</h1>
        <a style="text-decoration:none;color:inherit;" href="{% url 'blog-trending' %}"><button class="global-btn"><i class="fas fa-fire"></i>&nbsp;&nbsp;&nbsp;Trending</button></a>
        <a style="text-decoration:none;color:inherit;" href="{% url 'blog-curated' %}"><button class="global-btn"><i class="fas fa-pencil-alt"></i>&nbsp;&nbsp;&nbsp;Curated</button></a>
    </div>



    <!-- Preload animation -->
    <div class="timeline-wrapper" id="timeline-wrapper">
        <div class="timeline-item">
            <div class="animated-background">
                <div class="background-masker header-top"></div>
                <div class="background-masker header-left"></div>
                <div class="background-masker header-right"></div>
                <div class="background-masker header-bottom"></div>
                <div class="background-masker subheader-left"></div>
                <div class="background-masker subheader-right"></div>
                <div class="background-masker subheader-bottom"></div>
                <div class="background-masker content-top"></div>
                <div class="background-masker content-first-end"></div>
                <div class="background-masker content-second-line"></div>
                <div class="background-masker content-second-end"></div>
                <div class="background-masker content-third-line"></div>
                <div class="background-masker content-third-end"></div>
            </div>
        </div>
    </div>
    <div class="timeline-wrapper" id="timeline-wrapper-2">
        <div class="timeline-item">
            <div class="animated-background">
                <div class="background-masker header-top"></div>
                <div class="background-masker header-left"></div>
                <div class="background-masker header-right"></div>
                <div class="background-masker header-bottom"></div>
                <div class="background-masker subheader-left"></div>
                <div class="background-masker subheader-right"></div>
                <div class="background-masker subheader-bottom"></div>
                <div class="background-masker content-top"></div>
                <div class="background-masker content-first-end"></div>
                <div class="background-masker content-second-line"></div>
                <div class="background-masker content-second-end"></div>
                <div class="background-masker content-third-line"></div>
                <div class="background-masker content-third-end"></div>
            </div>
        </div>
    </div>
    <div class="timeline-wrapper" id="timeline-wrapper-3">
        <div class="timeline-item">
            <div class="animated-background">
                <div class="background-masker header-top"></div>
                <div class="background-masker header-left"></div>
                <div class="background-masker header-right"></div>
                <div class="background-masker header-bottom"></div>
                <div class="background-masker subheader-left"></div>
                <div class="background-masker subheader-right"></div>
                <div class="background-masker subheader-bottom"></div>
                <div class="background-masker content-top"></div>
                <div class="background-masker content-first-end"></div>
                <div class="background-masker content-second-line"></div>
                <div class="background-masker content-second-end"></div>
                <div class="background-masker content-third-line"></div>
                <div class="background-masker content-third-end"></div>
            </div>
        </div>
    </div>

    <div id="preload">
    {% for post in posts %}
        <sub>{{ forloop.counter }}</sub>
        <article class="blog-container" id="blog-container">
            <a href="{% url 'user-posts' post.author.username %}"><img class="author" src="{{ post.author.profile.image.url }}"></a>
                    <a class="author-title" href="{% url 'user-posts' post.author.username %}">{{ post.author }}{% if post.author.profile.verified %}&nbsp;&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>{% endif %}</a>
                {% if post.title %}        
                    <div class="blogs-title-close"><h2><a class="blogs-title" href="{% url 'post-detail' post.id %}">{{ post.title }}</a></h2></div>
                {% endif %}
                {% if post.content %}
                {% if post.title %}
                {% else %}
                <div style="height:15px"></div>
                {% endif %}
                {% if post.content|length > 200 %}
                <p class="blogs">{{ post.content|urlize|truncatechars:200 }}...&nbsp;<a class="a" href="{% url 'post-detail' post.id %}" style="font-family: 'Charter Bold', sans-serif;">Read More</a></p>
                {% else %}
                <a href="{% url 'post-detail' post.id %}"><p class="blogs">{{ post.content|urlize }}</p></a>
                {% endif %}
                {% endif %}
                {% if post.image %}
                <div class="cutoff" style="width: 100%;max-height: 800px;height:100%;overflow-y:hidden;margin-bottom: 25px;border-radius: 0px;">    
                    <img class="img-market" style="width: 100%;height:auto;" src="{{ post.image.url }}" alt="{{ post.name }} image">
                </div>
                <p class="blogs">{{ post.content|urlize|truncatechars:200 }}...&nbsp;<a class="a" href="{% url 'post-detail' post.id %}" style="font-family: 'Charter Bold', sans-serif;">Read More</a></p>
                {% endif %}
                {% if post.location %}
                    <p class="blogs-location">Post was made in <a class="a-location" target="_blank" href="https://www.google.com/maps/search/{{ post.location }}">{{ post.location|get_city_string }}</a>.&nbsp;&nbsp;&nbsp;<i class="fas fa-map-pin"></i></p>
                {% endif %}
                {% if post.author == user %}
                    <a href="{% url 'post-changelog' post.id %}" class="a-blue">See changelog&nbsp;&nbsp;&nbsp;<i class="fas fa-box"></i></a>
                {% endif %}
            <div class="clear">
                <h2 style="position: relative;font-family: 'Open Sans', sans-serif;float:left;font-size: 14px;color:#888;display: block;padding-left: 25px;padding-right: 25px;">{{ post.blog_views }} <i class="far fa-eye"></i>&nbsp;&nbsp;•&nbsp;&nbsp;{{ post.total_likes }}{% if user.is_authenticated %}<form action="{% url 'like-post' post.pk %}" method="POST" style="display: inline-block;">{% csrf_token %}<button type="submit" name="post_id" value="{{ post.id }}" style="border:none;background-color:transparent;color:inherit;"><i class="fas fa-heart"></i></button></form>{% else %} <i class="fas fa-heart"></i>{% endif %}&nbsp;&nbsp;•&nbsp;&nbsp;{{ post.comments.count }} <i class="fas fa-comment"></i></h2>
                    <sub style="display:none;pointer-events: none;" id="{{ post.id }}">localhost:8000{% url 'post-detail' post.id %}</sub>
                    <a onclick="copyToClipboard('#{{ post.id }}')" style="position: relative;font-family: 'Open Sans', sans-serif;float:right;font-size: 14px;color:#888;display: block;padding-left: 25px;padding-right: 25px;z-index: 1;">
                        <button class="btn-linker">
                            <i class="fas fa-link"></i>
                        </button>
                    </a>
            </div>
            {% if user.is_authenticated %}
                <a href="{% url 'add_comment' post.pk %}"><button class="btn-addcomment-home">Add comment</button></a>
            {% else %}
                <a href="{% url 'register' %}"><button class="btn-addcomment-home">Register or log in to comment</button></a>
            {% endif %}
            {% for comment in post.comments.all %}
            {% if forloop.first %}
                <div class="organize-comments ml-4 mr-4" style="margin-bottom: -5px !important;">
                    <h1 style="position: relative;font-family: 'Open Sans', sans-serif;font-size:14px;color:#777;text-align: left;">{{ comment.author }} - {{ comment.date_posted }}</h1>
                    <p style="font-size:15px;color:#777;">{{ comment.write_comment }}</p>
                </div>
            <a class="hover-a" href="{% url 'post-detail' post.id %}#comment-section" style="font-family: sans-serif;font-size:14px;line-height:50px;top:-5px;position:relative;font-weight:600;margin-left:20px;color:rgb(152, 152, 152);">See more</a>
            {% endif %}
            {% endfor %}
        </article>
        {% for ad in ads %}
            {% if forloop.parentloop.first %}
                {% if forloop.first %}
                <sub>{{ forloop.counter }}</sub>
                <a id="whyshowmethisad-resultbackgroundclick"><div id="whyshowmethisad-resultbackground"></div></a>
                <div id="whyshowmethisad-result">
                    <h1 style="font-family: 'Open Sans', sans-serif;font-size:18px;color:white;font-weight: 700;">{{ ad.author }}{% if ad.author.profile.verified %}&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>&nbsp;{% endif %} showed you this ad because:</h1>
                    <br />
                    <li style="font-size:17px;font-family: 'Charter', sans-serif;color:white;">You are {% if user.profile.Choose_gender == "" %}classified by Product as None. Set a <a href="{% url 'profile' %}" class="a">gender</a>.{% elif user.profile.Choose_gender == 'M' %}male{% elif user.profile.Choose_gender == 'F' %}female{% elif user.profile.Choose_gender == 'O' %}classified as non-binary{% else %}not signed in. We are showing you a normal ad.{% endif %}</li>
                    <li style="font-size:17px;font-family: 'Charter', sans-serif;color:white;">You live in {% if user.profile.Current_city == "" %} an unspecified area. Set your location <a href="{% url 'profile' %}" class="a">here</a>.{% elif user.profile.Current_city %}<a class="a-location" target="_blank" href="https://www.google.com/maps/search/{{ post.location }}">{{ user.profile.Current_city|get_city_string }}</a>&nbsp;<i class="fas fa-map-pin"></i>.{% else %}an unknown place. Log in.{% endif %}</li>
                    <div style="border-left: solid 2px #999;padding-left:10px;margin-top:25px;"><small style="color:#777;white-space: break-word;">Product is currently working on better targeting. This will be released in a future update.</small></div>
                </div>
                    <div class="blog-container-ads" id="blog-container">
                        <a href="{% url 'ad-detail' ad.id %}" target="_self" style="color: inherit;text-decoration:none;">
                            <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 14px;color:rgb(181, 181, 181);font-weight: 500;padding-left:25px;margin-top: 5px;margin-bottom: -20px;">Sponsored <i class="fas fa-external-link-alt"></i>&nbsp;&nbsp;&nbsp;<span style="font-size:13px;color:#888;">Click on post to learn more</span></p>
                            <img class="author" src="{{ ad.author.profile.image.url }}">
                        </a>
                        <button class="whythisad" id="ebtn{{ forloop.counter }}"><i class="fas fa-ellipsis-h"></i></button>
                        <div class="whythisad-dropdown" id="result{{ forloop.counter }}">
                            <span style="color:rgb(213, 213, 213);font-family: 'Open Sans', sans-serif;font-size:16px;font-weight:800;padding-left:8px;">Ad Options</span>
                            <div style="height:25px;"></div>
                        {% if user.is_authenticated %}
                            <button class="whythisad-options" style="margin-bottom: 10px;" id="whyshowmethisad">Why show me this ad?</button>
                        {% endif %}
                            <button class="whythisad-options" id="ilikethisad">I like this ad</button>
                        </div>
                        <a href="{% url 'ad-detail' ad.id %}" target="_self" style="color: inherit;text-decoration:none;">
                        <span class="author-title">{{ ad.author }}{% if ad.author.profile.verified %}&nbsp;&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>{% endif %}</span>     
                        <div class="blogs-title-close"><h2><span class="blogs-title">{{ ad.title }}</span></h2></div>
                        <p class="blogs">{{ ad.content|urlize|truncatechars:200 }}</p>
                            {% if ad.image %}
                            <div class="cutoff" style="margin-top:0px;width: 100%;max-height: 800px;height:100%;overflow-y:hidden;border-radius: 0px;">    
                                <img class="img-market" style="width: 100%;height:auto;" src="{{ ad.image.url }}" alt="{{ ad.name }} image">
                            </div>
                            {% endif %}
                        </a>
                        </div>
            {% endif %}
            {% endif %}
        {% endfor %}
        {% for ad in ads2 %}
            {% if forloop.parentloop.counter == 4 %}
            {% if forloop.first %}
            <sub>{{ forloop.counter }}</sub>
                <a href="{% url 'ad-detail' ad.id %}" target="_self" style="display:block;color: inherit;text-decoration:none;">
                    <div class="blog-container-ads" id="blog-container">
                        <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 14px;color:rgb(181, 181, 181);font-weight: 500;padding-left:25px;margin-top: 5px;margin-bottom: -20px;">Sponsored <i class="fas fa-external-link-alt"></i>&nbsp;&nbsp;&nbsp;<span style="font-size:13px;color:#888;">Click on post to learn more</span></p>
                        <img class="author" src="{{ ad.author.profile.image.url }}">
                        <span class="author-title">{{ ad.author }}{% if ad.author.profile.verified %}&nbsp;&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>{% endif %}</span>     
                        <div class="blogs-title-close"><h2><span class="blogs-title">{{ ad.title }}</span></h2></div>
                        <p class="blogs">{{ ad.content|urlize|truncatechars:200 }}</p>
                            {% if ad.image %}
                            <div class="cutoff" style="margin-top:0px;width: 100%;max-height: 800px;height:100%;overflow-y:hidden;border-radius: 0px;">    
                                <img class="img-market" style="width: 100%;height:auto;" src="{{ ad.image.url }}" alt="{{ ad.name }} image">
                            </div>
                            {% endif %}
                        </div>
            </a>
            {% endif %}
            {% endif %}
        {% endfor %}
        {% for ad in ads3 %}
            {% if forloop.parentloop.counter == 7 %}
            {% if forloop.first %}
            <sub>{{ forloop.counter }}</sub>
                <a href="{% url 'ad-detail' ad.id %}" target="_self" style="display:block;color: inherit;text-decoration:none;">
                    <div class="blog-container-ads" id="blog-container">
                        <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 14px;color:rgb(181, 181, 181);font-weight: 500;padding-left:25px;margin-top: 5px;margin-bottom: -20px;">Sponsored <i class="fas fa-external-link-alt"></i>&nbsp;&nbsp;&nbsp;<span style="font-size:13px;color:#888;">Click on post to learn more</span></p>
                        <img class="author" src="{{ ad.author.profile.image.url }}">
                        <span class="author-title">{{ ad.author }}{% if ad.author.profile.verified %}&nbsp;&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>{% endif %}</span>     
                        <div class="blogs-title-close"><h2><span class="blogs-title">{{ ad.title }}</span></h2></div>
                        <p class="blogs">{{ ad.content|urlize|truncatechars:200 }}</p>
                            {% if ad.image %}
                            <div class="cutoff" style="margin-top:0px;width: 100%;max-height: 800px;height:100%;overflow-y:hidden;border-radius: 0px;">    
                                <img class="img-market" style="width: 100%;height:auto;" src="{{ ad.image.url }}" alt="{{ ad.name }} image">
                            </div>
                            {% endif %}
                        </div>
            </a>
            {% endif %}
            {% endif %}
        {% endfor %}
        {% for ad in ads4 %}
            {% if forloop.parentloop.last %}
            {% if forloop.first %}
            <sub>{{ forloop.counter }}</sub>
                <a href="{% url 'ad-detail' ad.id %}" target="_self" style="display:block;color: inherit;text-decoration:none;">
                    <div class="blog-container-ads" id="blog-container">
                        <p style="position: relative;font-family: 'Open Sans', sans-serif;font-size: 14px;color:rgb(181, 181, 181);font-weight: 500;padding-left:25px;margin-top: 5px;margin-bottom: -20px;">Sponsored <i class="fas fa-external-link-alt"></i>&nbsp;&nbsp;&nbsp;<span style="font-size:13px;color:#888;">Click on post to learn more</span></p>
                        <img class="author" src="{{ ad.author.profile.image.url }}">
                        <span class="author-title">{{ ad.author }}{% if ad.author.profile.verified %}&nbsp;&nbsp;<i class="fas fa-check-circle" style="color:#777;"></i>{% endif %}</span>     
                        <div class="blogs-title-close"><h2><span class="blogs-title">{{ ad.title }}</span></h2></div>
                        <p class="blogs">{{ ad.content|urlize|truncatechars:200 }}</p>
                            {% if ad.image %}
                            <div class="cutoff" style="margin-top:0px;width: 100%;max-height: 800px;height:100%;overflow-y:hidden;border-radius: 0px;">    
                                <img class="img-market" style="width: 100%;height:auto;" src="{{ ad.image.url }}" alt="{{ ad.name }} image">
                            </div>
                            {% endif %}
                        </div>
            </a>
            {% endif %}
            {% endif %}
        {% endfor %}
    {% endfor %}
</div>
    {% if is_paginated %}
        <br />
        {% if page_obj.has_previous %}
            <a class="btn btn-outline-info mb-4" href="?page=1">First</a>
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
                <a class="btn btn-info mb-4" href="?page={{ num }}">{{ num }}</a>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'+3' %}
                <a class="btn btn-outline-info mb-4" href="?page={{ num }}">{{ num }}</a>
            {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.next_page_number }}">Next</a>
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.paginator.num_pages }}">Last</a>
        {% endif %}

    {% endif %}


    {% if user.is_authenticated %}
    {% else %}
            <div class="sign-up-log-in">
                <h1 style="position: relative;padding-left: 50px;padding-right: 50px;font-family: 'Open Sans', sans-serif;font-size: 28px;color: white;font-weight: 900;padding-top: 50px;padding-bottom: 50px;display: inline-block;">Free speech deserves an outlet. Create a free account on Product today.</h1>

                <a class="a" href="{% url 'register' %}"><button class="btn-register-2">Register</button></a>
                <a class="a" href="{% url 'login' %}"><button class="btn-login-2">Login</button></a>
            </div>
            <div class="sign-up-log-in-2">
                <h1 style="position: relative;padding-left: 50px;padding-right: 50px;font-family: 'Open Sans', sans-serif;font-size: 28px;color: white;font-weight: 900;padding-top: 50px;padding-bottom: 50px;display: inline-block;">Free speech deserves an outlet. Create a free account on Product today.</h1>

                <a class="a" href="{% url 'register' %}"><button class="btn-register-2">Register</button></a>
                <a class="a" href="{% url 'login' %}"><button class="btn-login-2">Login</button></a>
            </div>

            <div class="sign-up-log-in-mobile">
                <h1 style="position: relative;padding-left: 50px;padding-right: 50px;font-family: 'Open Sans', sans-serif;font-size: 28px;color: white;font-weight: 900;padding-top: 50px;padding-bottom: 50px;display: inline-block;">Free speech deserves an outlet. Create a free account on Product today.</h1>

                <a class="a" href="{% url 'register' %}"><button class="btn-register-2">Register</button></a>
                <a class="a" href="{% url 'login' %}"><button class="btn-login-2">Login</button></a>
            </div>
    {% endif %}

    <script>
        function copyToClipboard(element) {
            var $temp = $("<input>");
            $("body").append($temp);
            $temp.val($(element).text()).select();
            document.execCommand("copy");
            $temp.remove();
        }

        $('#ebtn1').click(function() {     
            $('#result1').slideToggle();
        });

        $('#whyshowmethisad').click(function() {
            $('#whyshowmethisad-result').toggle();
            $('#whyshowmethisad-resultbackground').toggle();
        })
        $('#whyshowmethisad-resultbackground').click(function() {
            $('#whyshowmethisad-result').toggle();
            $('#whyshowmethisad-resultbackground').toggle();
        })

        $('#ilikethisad').click(function() {
            $('#ilikethisad').css('backgroundColor', 'rgb(45, 255, 157)');
            $('#ilikethisad').css('color', '#111');
        })
        
    </script>
{% endblock content %}


